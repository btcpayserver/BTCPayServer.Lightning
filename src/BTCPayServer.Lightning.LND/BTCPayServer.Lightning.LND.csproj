<Project Sdk="Microsoft.NET.Sdk">

	<PropertyGroup>
		<TargetFramework>netstandard2.0</TargetFramework>
		<Version>1.2.4</Version>
		<LangVersion>7.3</LangVersion>
		<PackageId>BTCPayServer.Lightning.LND</PackageId>
		<Description>Client library for LND to build Lightning Network Apps in C#.</Description>
		<PackageProjectUrl>https://github.com/btcpayserver/BTCPayServer.Lightning</PackageProjectUrl>
		<RepositoryUrl>https://github.com/btcpayserver/BTCPayServer.Lightning</RepositoryUrl>
    <PackageLicenseExpression>MIT</PackageLicenseExpression>
		<PackageTags>lightning;bitcoin;lnd;lapps</PackageTags>
	</PropertyGroup>

	<ItemGroup>
		<PackageReference Include="System.Threading.Channels" Version="4.5.0" />
	</ItemGroup>

	<ItemGroup>
		<ProjectReference Include="..\BTCPayServer.Lightning.Common\BTCPayServer.Lightning.Common.csproj" />
	</ItemGroup>

	<Target Name="GenerateNSwagClient">
		<PropertyGroup>
			<LndVersion>v0.12.0-beta</LndVersion>
			<InputSwagger>lnd.rpc.swagger.$(LndVersion).json</InputSwagger>
			<ClientName>LndSwaggerClient</ClientName>
			<GeneratedSwaggerClientFile Condition="'$(GeneratedSwaggerClientFile)' ==''">LndSwaggerClient.cs</GeneratedSwaggerClientFile>
		</PropertyGroup>
		<Exec Command="dotnet nswag run nswag.json /variables:LndVersion=$(LndVersion),InputSwagger=$(InputSwagger),ClientName=$(ClientName),ClientNamespace=$(RootNamespace),GeneratedSwaggerClientFile=$(GeneratedSwaggerClientFile)" />
	</Target>
	
	<Target Name="IncludeNSwagClient" BeforeTargets="CoreCompile" DependsOnTargets="GenerateNSwagClient">
		<ItemGroup Condition="Exists('$(GeneratedSwaggerClientFile)')">
		<Compile Include="$(GeneratedSwaggerClientFile)" />
		<FileWrites Include="$(GeneratedSwaggerClientFile)" />
		</ItemGroup>
	</Target>
</Project>
